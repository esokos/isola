      SUBROUTINE FW(S)
      COMMON/COM/FLE,FLI,FRI,FRE,DF,ILS,IRS,NT,NTM
      DIMENSION  S(8192)
      COMPLEX S
C
      FEXP=1.
C
      PI=3.141592
      ILEFT=FLI/DF+1.1
      IRIGHT=FRI/DF+1.1
      IF(IRIGHT.GT.IRS)IRIGHT=IRS
      IF(ILEFT.LT.ILS)ILEFT=ILS
      IF(IRIGHT.GT.NTM)IRIGHT=NTM
      NLEFT=ILEFT-ILS
      NRIGHT=IRS-IRIGHT
      IF(NLEFT.GT.0)DLEFT=PI/FLOAT(NLEFT)
      IF(NRIGHT.GT.0)DRIGHT=PI/FLOAT(NRIGHT)
C
      NTT=NT+2
      DO 1 I=1,NTM
      J=NTT-I
      FIF=I-IRIGHT
      FAF=I-ILS
      IF(I.GE.ILEFT.AND.I.LE.IRIGHT)GO TO 1
      IF(I.LE.ILS.OR.I.GE.IRS)S(I)=(0.0,0.0)
      IF(I.GT.ILS.AND.I.LT.ILEFT)
     1S(I)=S(I)*(0.5*(1.-COS(DLEFT*FAF)))**FEXP
      IF(I.GT.IRIGHT.AND.I.LT.IRS)
     1S(I)=S(I)*(0.5*(COS(DRIGHT*FIF)+1.))**FEXP
      IF(I.EQ.1.OR.I.EQ.NTM)GO TO 1
      S(J)=CONJG(S(I))
    1 CONTINUE
C
      RETURN
      END
